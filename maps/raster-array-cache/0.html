<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>rasterarray maxTileCacheSize=0</title>
  <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
  <link href="https://api.mapbox.com/mapbox-gl-js/v3.17.0/mapbox-gl.css" rel="stylesheet">
  <script src="https://api.mapbox.com/mapbox-gl-js/v3.17.0/mapbox-gl.js"></script>
  <style>
    body {
      margin: 0;
      padding: 0;
    }

    #map {
      position: absolute;
      top: 0;
      bottom: 0;
      width: 100%;
    }
  </style>
</head>

<body>
  <style>
    .btn-control {
      font:
        bold 12px/20px 'Helvetica Neue',
        Arial,
        Helvetica,
        sans-serif;
      background-color: #3386c0;
      color: #fff;
      position: absolute;
      top: 20px;
      left: 50%;
      z-index: 1;
      border: none;
      width: 200px;
      margin-left: -100px;
      display: block;
      cursor: pointer;
      padding: 10px 20px;
      border-radius: 3px;
    }

    .btn-control:hover {
      background-color: #4ea0da;
    }
  </style>
  <div id="map"></div>
  <button id="switch" class="btn-control">Switch Layers</button>

  <script>
    const token = 'pk.eyJ1IjoianRvZ2FzaGkiLCJhIjoiY21pcGcwemUyMDR4ODNoc2EyNXhiZHpoYSJ9.RO3RqSrLbOPj_Zrt5Aocqg';
    const style = 'mapbox://styles/jtogashi/cmganq7j6001d01sngppg9pge/draft';
    let layers = [];
    let currentVisibleLayer = 0;

    mapboxgl.accessToken = token;

    const map = new mapboxgl.Map({
      container: 'map',
      style: style,
      center: [135.548, 35.881],
      zoom: 5.5,
      maxTileCacheSize: 0
    });

    map.on('load', () => {
      layers = map.getStyle().layers;
      const visibleLayerIndex = layers.findIndex((layer) => {
        return map.getLayoutProperty(layer.id, 'visibility') !== 'none';
      });
      currentVisibleLayer = visibleLayerIndex;
    });

    document.getElementById('switch').addEventListener('click', () => {
      updateVisibility();
    });

    function updateVisibility() {
      map.setLayoutProperty(layers[currentVisibleLayer].id, 'visibility', 'none');
      if (currentVisibleLayer >= layers.length - 1) {
        currentVisibleLayer = 0;
      } else {
        currentVisibleLayer++;
      }

      map.setLayoutProperty(layers[currentVisibleLayer].id, 'visibility', 'visible');
    }
  </script>

</body>

</html>
